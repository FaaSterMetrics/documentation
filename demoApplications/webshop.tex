\documentclass[../main.tex]{subfiles}
\begin{document}

As part of our project, we implemented two fully instrumented FaaS based demo applications:
An e-commerce application (i.e.\@ a webshop) and an IoT-resembling traffic light calculator for some road crossing.
They serve both as examples how to build fully working and adaptively deployable applications 
within our framework as well as a baseline for real application-oriented FaaS benchmarks.

\section{E-Commerce Application (Webshop)}\label{sec:webshop}

% Design Concepts
We implemented a test e-commerce application that fully consists of FaaS components together with a redis database. 
The basic functionality is to display recommended products and ads to customers 
who can then buy said products by charging a mocked credit card. 
As such, the deployed application can theoretically be ``used'' exclusively by humans 
interacting with its website frontend within a web browser.
Naturally, there are also pre-defined automized workloads to secure a benchmark's reproducibility.

The whole functionality is closely oriented on Googleâ€™s microservices demo v0.1.0\footnotemark{} 
but has of course been fully reimplemented as a FaaS project (except some HTML templates as referenced within their code directory). 
\footnotetext{\url{https://github.com/GoogleCloudPlatform/microservices-demo/tree/bae651f7ea537d2676b38a04d89adacdd45c17bd}}

\subsection{Application Structure}\label{ssec:webshopApplicationStructure}

\begin{figure}
\begin{center}
  \includegraphics[width=\linewidth,keepaspectratio]{./webshop-architecture-diagram.png}
\end{center}
\caption[Webshop Architecture Diagram]{%
  Webshop architecture diagram as illustrated by Google\protect\footnotemark.
  %TODO remove external API
  All `services' as well as the frontend are implemented as separate functions within our demo application. 
  They communicate internally with each other via our library's RPC system and are thus automatically measured at runtime.%
}%
\label{fig:webshopArchitectureDiagram}
\end{figure}
\footnotetext{\url{https://raw.githubusercontent.com/GoogleCloudPlatform/microservices-demo/bae651f7ea537d2676b38a04d89adacdd45c17bd/docs/img/architecture-diagram.png}}

\begin{longtable}{l l l} 
  \caption[Webshop Function Overview]{Webshop Function Overview\vspace*{1mm}}\label{tab:requiredTools}\\
  \textbf{Service} & \textbf{Function} &  \textbf{Description}\\ 
  \toprule
  %\endhead{}%
  Frontend                                & frontend            & 
  \makecell[l]{Receives user requests and displays webpage. \\
    Calls all other functions (except payment, e- \\
    mail and shiporder) depending on requests.}\\
  \midrule[0.02em]
  \multirow{3}{*}{Product Catalog Service}& getproduct          &
  \makecell[l]{Returns all data about a product given its ID.}\\
  \cmidrule[0.02em]{2-3}
                                          & listproducts        &
  \makecell[l]{Returns all data about available products.}\\
  \cmidrule[0.02em]{2-3}
                                          & searchproducts      &
  \makecell[l]{Searches product catalog for some string and \\
    returns all matching products.}\\
  \midrule[0.02em]
  Recommendation Service                  & listrecommendations &
  \makecell[l]{Takes a list of product IDs, responds with \\
    list of up to 7 other related (`recommended') \\
    product IDs.}\\
  \midrule[0.02em]
  \multirow{4}{*}{Cart Service}           & getcart             & 
  \makecell[l]{Returns a given user's shopping cart.}\\
  \cmidrule[0.02em]{2-3}
                                          & addcartitem         & 
  \makecell[l]{Adds an item to a user's shopping cart.}\\
  \cmidrule[0.02em]{2-3}
                                          & emptycart           & 
  \makecell[l]{Empties a given user's shopping cart.}\\
  \cmidrule[0.02em]{2-3}
                                          & cartkvstorage       & 
  \makecell[l]{Manages the internal cart database. Only call-\\
    ed by the other cart service functions.}\\
  \midrule[0.02em]
  Checkout Service                        & checkout            &
    \makecell[l]{Handles a checkout process when requested \\
    by user (via frontend). Involves e.g.\@ calling \\
    payment, shiporder, email and emptycart.}\\
  \midrule[0.02em]
  \multirow{2}{*}{Currency Service}       & currency            &
  \makecell[l]{Converts a price from one currency to another.}\\
  \cmidrule[0.02em]{2-3}
                                          & supportedcurrencies &
  \makecell[l]{Returns a list of all supported currencies.}\\
  \midrule[0.02em]
  Payment Service                         & payment             &
  \makecell[l]{Handles a payment.}\\
  \midrule[0.02em]
  \multirow{2}{*}{Shipping Service}       & shipmentquote       &
  \makecell[l]{Calculates cost of shipping a given order.}\\
  \cmidrule[0.02em]{2-3}
                                          & shiporder           &
  \makecell[l]{Handles actual shipping of an order.}\\
  \midrule[0.02em]
  Email Service                           & email               &
  \makecell[l]{Sends a confirmation email.}\\
  \midrule[0.02em]
  Ad Service                              & getads              &
  \makecell[l]{Supplies links to random cat pictures.}\\
  \bottomrule
\end{longtable}

% TODO functionality description

% TODO Call Spec Appendix
Exact Function I/O specification can also be looked up within the source code\footnotemark.
There, each function has its own I/O behaviour (including individual examples) documented.
\footnotetext{\url{https://github.com/FaaSterMetrics/experiments/tree/master/experiments/webservice/functions}}



\subsection{Benchmarking Properties}\label{ssec:webshopApplicationProperties}


\subsection{Specific Workloads}\label{ssec:webshopSpecificWorkloads}


\end{document}
